CREATE TABLE employees(
	emp_id serial PRIMARY KEY,
	first_name TEXT,
	last_name TEXT,
	salary int
);


insert into employees (first_name, last_name, salary) values ('Wini', 'Odda', 44740);
insert into employees (first_name, last_name, salary) values ('Grace', 'Vandenhoff', 54524);
insert into employees (first_name, last_name, salary) values ('Prescott', 'Larder', 92199);
insert into employees (first_name, last_name, salary) values ('Kevina', 'Manes', 43442);
insert into employees (first_name, last_name, salary) values ('Michael', 'Zorener', 64007);
insert into employees (first_name, last_name, salary) values ('Gerta', 'Maunsell', 94537);
insert into employees (first_name, last_name, salary) values ('Steven', 'Goodayle', 59694);
insert into employees (first_name, last_name, salary) values ('Hedvig', 'Giovanni', 93592);
insert into employees (first_name, last_name, salary) values ('Phillie', 'L''Episcopi', 67761);
insert into employees (first_name, last_name, salary) values ('Clementina', 'Tutton', 89149);
insert into employees (first_name, last_name, salary) values ('Siegfried', 'Bownes', 66375);
insert into employees (first_name, last_name, salary) values ('Hatti', 'Pohlke', 72844);
insert into employees (first_name, last_name, salary) values ('Bunni', 'Rodrigues', 86323);
insert into employees (first_name, last_name, salary) values ('Clemence', 'Escoffrey', 30131);
insert into employees (first_name, last_name, salary) values ('Rebekah', 'Chitter', 69542);
insert into employees (first_name, last_name, salary) values ('Licha', 'Byllam', 46714);
insert into employees (first_name, last_name, salary) values ('Shandeigh', 'Byk', 35169);
insert into employees (first_name, last_name, salary) values ('Catriona', 'Mordaunt', 69300);
insert into employees (first_name, last_name, salary) values ('Stanley', 'Torrisi', 36746);
insert into employees (first_name, last_name, salary) values ('Luther', 'Broker', 79089);
insert into employees (first_name, last_name, salary) values ('Elvis', 'Boyde', 74463);
insert into employees (first_name, last_name, salary) values ('Burg', 'Cianelli', 46825);
insert into employees (first_name, last_name, salary) values ('Van', 'Antat', 73619);
insert into employees (first_name, last_name, salary) values ('Darbee', 'Gladwell', 42704);
insert into employees (first_name, last_name, salary) values ('Buck', 'Klimkov', 71177);
insert into employees (first_name, last_name, salary) values ('Selina', 'Quaif', 81731);
insert into employees (first_name, last_name, salary) values ('Deidre', 'Sartain', 76485);
insert into employees (first_name, last_name, salary) values ('Emilie', 'Lardeux', 70599);
insert into employees (first_name, last_name, salary) values ('Rozanna', 'Ghidetti', 59540);
insert into employees (first_name, last_name, salary) values ('Olivier', 'Dominguez', 84870);
insert into employees (first_name, last_name, salary) values ('Nancee', 'Osmant', 50144);
insert into employees (first_name, last_name, salary) values ('Peyter', 'Matteris', 47001);
insert into employees (first_name, last_name, salary) values ('Malia', 'Batchelour', 46778);
insert into employees (first_name, last_name, salary) values ('Maria', 'Thunnercliff', 56777);
insert into employees (first_name, last_name, salary) values ('Jennee', 'Kilmartin', 73419);
insert into employees (first_name, last_name, salary) values ('Esma', 'Meredith', 78058);
insert into employees (first_name, last_name, salary) values ('Valerie', 'Fareweather', 78622);
insert into employees (first_name, last_name, salary) values ('Winnie', 'Osgood', 90210);
insert into employees (first_name, last_name, salary) values ('Kary', 'Seson', 32131);
insert into employees (first_name, last_name, salary) values ('Hadleigh', 'Tanti', 92227);
insert into employees (first_name, last_name, salary) values ('Yvette', 'Scothorn', 38889);
insert into employees (first_name, last_name, salary) values ('Doro', 'Bourbon', 79601);
insert into employees (first_name, last_name, salary) values ('Dalston', 'Towsey', 85063);
insert into employees (first_name, last_name, salary) values ('Tristan', 'Aguilar', 92004);
insert into employees (first_name, last_name, salary) values ('Jan', 'Beakes', 98297);
insert into employees (first_name, last_name, salary) values ('Ronnica', 'Le Marchant', 84025);
insert into employees (first_name, last_name, salary) values ('Salvatore', 'Gotecliffe', 87333);
insert into employees (first_name, last_name, salary) values ('Kiri', 'Crossgrove', 34175);
insert into employees (first_name, last_name, salary) values ('Uriah', 'Bilbie', 40217);
insert into employees (first_name, last_name, salary) values ('Marylin', 'Joye', 67465);
insert into employees (first_name, last_name, salary) values ('Happy', 'Sellens', 77629);
insert into employees (first_name, last_name, salary) values ('Nydia', 'Valentinuzzi', 78711);
insert into employees (first_name, last_name, salary) values ('Axe', 'Vegas', 57485);
insert into employees (first_name, last_name, salary) values ('Renie', 'De Antoni', 76722);
insert into employees (first_name, last_name, salary) values ('Miriam', 'Galiford', 97357);
insert into employees (first_name, last_name, salary) values ('Angy', 'Littefair', 33767);
insert into employees (first_name, last_name, salary) values ('Cirilo', 'Criag', 99829);
insert into employees (first_name, last_name, salary) values ('Jay', 'Consterdine', 48755);
insert into employees (first_name, last_name, salary) values ('Esme', 'Chevalier', 46889);
insert into employees (first_name, last_name, salary) values ('Doralynne', 'Mattia', 41151);
insert into employees (first_name, last_name, salary) values ('Bondie', 'Rubroe', 39414);
insert into employees (first_name, last_name, salary) values ('Francisca', 'Truce', 67601);
insert into employees (first_name, last_name, salary) values ('Margie', 'Wille', 97458);
insert into employees (first_name, last_name, salary) values ('Christean', 'Nancekivell', 71316);
insert into employees (first_name, last_name, salary) values ('Elyssa', 'Keeves', 66212);
insert into employees (first_name, last_name, salary) values ('Marlena', 'Yakunikov', 50463);
insert into employees (first_name, last_name, salary) values ('Lucais', 'Follows', 44917);
insert into employees (first_name, last_name, salary) values ('Halley', 'Wallice', 81049);
insert into employees (first_name, last_name, salary) values ('Elmer', 'Cardenoza', 61762);
insert into employees (first_name, last_name, salary) values ('Maxi', 'Ahren', 65260);
insert into employees (first_name, last_name, salary) values ('Bertram', 'Blunt', 62215);
insert into employees (first_name, last_name, salary) values ('Leda', 'Fullard', 86768);
insert into employees (first_name, last_name, salary) values ('Rouvin', 'Hincks', 75123);
insert into employees (first_name, last_name, salary) values ('Annis', 'Stienham', 67314);
insert into employees (first_name, last_name, salary) values ('Sorcha', 'Fass', 49993);
insert into employees (first_name, last_name, salary) values ('Onida', 'Rawstorne', 83921);
insert into employees (first_name, last_name, salary) values ('Hartley', 'Cohane', 61082);
insert into employees (first_name, last_name, salary) values ('Davidde', 'Allcott', 43272);
insert into employees (first_name, last_name, salary) values ('Hirsch', 'Kettell', 60791);
insert into employees (first_name, last_name, salary) values ('Eleen', 'Bangle', 42156);
insert into employees (first_name, last_name, salary) values ('Shalne', 'Duncanson', 45062);
insert into employees (first_name, last_name, salary) values ('Kissee', 'Labro', 43141);
insert into employees (first_name, last_name, salary) values ('Caryn', 'Ebbs', 57133);
insert into employees (first_name, last_name, salary) values ('Berni', 'Raspin', 79456);
insert into employees (first_name, last_name, salary) values ('Calida', 'Stean', 88584);
insert into employees (first_name, last_name, salary) values ('Morgen', 'Canwell', 67420);
insert into employees (first_name, last_name, salary) values ('Delora', 'Lumbers', 63934);
insert into employees (first_name, last_name, salary) values ('Jody', 'Matteuzzi', 81413);
insert into employees (first_name, last_name, salary) values ('Germaine', 'MacPhail', 31499);
insert into employees (first_name, last_name, salary) values ('Berk', 'Gabey', 88822);
insert into employees (first_name, last_name, salary) values ('Nalani', 'Goldbourn', 64721);
insert into employees (first_name, last_name, salary) values ('Hermie', 'Storey', 71804);
insert into employees (first_name, last_name, salary) values ('Vyky', 'Khotler', 75103);
insert into employees (first_name, last_name, salary) values ('Lydie', 'Schanke', 36984);
insert into employees (first_name, last_name, salary) values ('Bone', 'Boutellier', 56297);
insert into employees (first_name, last_name, salary) values ('Forest', 'Torbett', 32953);
insert into employees (first_name, last_name, salary) values ('Marve', 'Maharey', 45001);
insert into employees (first_name, last_name, salary) values ('Sheri', 'Matys', 99579);
insert into employees (first_name, last_name, salary) values ('Derril', 'Blainey', 88380);
insert into employees (first_name, last_name, salary) values ('Paulie', 'Hitchens', 34164);

SELECT * FROM Employees;
SELECT SUM(salary) FROM EMPLOYEES;

SELECT * FROM employees WHERE first_name = 'Paulie';

UPDATE EMPLOYEES SET FIRST_NAME = 'Pauly' WHERE EMP_ID = 100;

SELECT * FROM employees WHERE first_name = 'Pauly';


create table employees2 (
	first_name VARCHAR(50),
	last_name VARCHAR(50),
	salary INT,
	department VARCHAR(50)
);
insert into employees2 (first_name, last_name, salary, department) values ('Alleen', 'De Bruyn', 31411, 'Marketing');
insert into employees2 (first_name, last_name, salary, department) values ('Onfre', 'Voce', 27188, 'Accounting');
insert into employees2 (first_name, last_name, salary, department) values ('Charlot', 'Montford', 27169, 'Sales');
insert into employees2 (first_name, last_name, salary, department) values ('Willey', 'Worling', 71347, 'Marketing');
insert into employees2 (first_name, last_name, salary, department) values ('Donny', 'Mattusov', 23732, 'Services');
insert into employees2 (first_name, last_name, salary, department) values ('Pam', 'Goburn', 68001, 'Legal');
insert into employees2 (first_name, last_name, salary, department) values ('Cully', 'Oehm', 75309, 'Training');
insert into employees2 (first_name, last_name, salary, department) values ('Sammy', 'McKearnen', 54832, 'Business Development');
insert into employees2 (first_name, last_name, salary, department) values ('Ivy', 'Hamflett', 84487, 'Product Management');
insert into employees2 (first_name, last_name, salary, department) values ('Eudora', 'MacCarlich', 50446, 'Marketing');
insert into employees2 (first_name, last_name, salary, department) values ('Josee', 'Marshman', 81311, 'Research and Development');
insert into employees2 (first_name, last_name, salary, department) values ('Karine', 'Maken', 79198, 'Training');
insert into employees2 (first_name, last_name, salary, department) values ('Felice', 'Lechelle', 53149, 'Engineering');
insert into employees2 (first_name, last_name, salary, department) values ('Lay', 'Beton', 18008, 'Research and Development');
insert into employees2 (first_name, last_name, salary, department) values ('Dorene', 'Felstead', 97674, 'Research and Development');
insert into employees2 (first_name, last_name, salary, department) values ('Luise', 'Fligg', 27665, 'Services');
insert into employees2 (first_name, last_name, salary, department) values ('Marco', 'Sergison', 56978, 'Services');
insert into employees2 (first_name, last_name, salary, department) values ('Bonnibelle', 'Biesterfeld', 69543, 'Services');
insert into employees2 (first_name, last_name, salary, department) values ('Gwen', 'Goodright', 63737, 'Business Development');
insert into employees2 (first_name, last_name, salary, department) values ('Lorelei', 'Snowling', 21928, 'Research and Development');
insert into employees2 (first_name, last_name, salary, department) values ('Alwin', 'Iacomelli', 56895, 'Sales');
insert into employees2 (first_name, last_name, salary, department) values ('Gayel', 'Philipsson', 40544, 'Support');
insert into employees2 (first_name, last_name, salary, department) values ('Giusto', 'Benedit', 67771, 'Marketing');
insert into employees2 (first_name, last_name, salary, department) values ('Tam', 'Mitchinson', 11293, 'Business Development');
insert into employees2 (first_name, last_name, salary, department) values ('Somerset', 'Gerhold', 88859, 'Product Management');
insert into employees2 (first_name, last_name, salary, department) values ('Mano', 'Ahlin', 78460, 'Services');
insert into employees2 (first_name, last_name, salary, department) values ('Lisbeth', 'Slemming', 45821, 'Training');
insert into employees2 (first_name, last_name, salary, department) values ('Marisa', 'Giacubbo', 72443, 'Support');
insert into employees2 (first_name, last_name, salary, department) values ('Nicola', 'Clemes', 88288, 'Support');
insert into employees2 (first_name, last_name, salary, department) values ('Cecilia', 'Pullan', 26965, 'Engineering');
insert into employees2 (first_name, last_name, salary, department) values ('Karry', 'Bannell', 33247, 'Research and Development');
insert into employees2 (first_name, last_name, salary, department) values ('Mela', 'Trim', 85700, 'Accounting');
insert into employees2 (first_name, last_name, salary, department) values ('Rosita', 'Breissan', 32545, 'Business Development');
insert into employees2 (first_name, last_name, salary, department) values ('Myrtice', 'Landon', 85517, 'Sales');
insert into employees2 (first_name, last_name, salary, department) values ('Hetti', 'Deners', 66555, 'Training');
insert into employees2 (first_name, last_name, salary, department) values ('Prudi', 'Sacker', 97046, 'Support');
insert into employees2 (first_name, last_name, salary, department) values ('Leslie', 'Ubsdall', 87139, 'Research and Development');
insert into employees2 (first_name, last_name, salary, department) values ('Veradis', 'Honniebal', 91302, 'Engineering');
insert into employees2 (first_name, last_name, salary, department) values ('Dorisa', 'MacMakin', 70518, 'Training');
insert into employees2 (first_name, last_name, salary, department) values ('Dot', 'Wyldbore', 68318, 'Training');
insert into employees2 (first_name, last_name, salary, department) values ('Granger', 'Mungane', 41901, 'Product Management');
insert into employees2 (first_name, last_name, salary, department) values ('Peggy', 'Birkmyr', 18433, 'Human Resources');
insert into employees2 (first_name, last_name, salary, department) values ('Craggie', 'Bande', 81292, 'Training');
insert into employees2 (first_name, last_name, salary, department) values ('Arel', 'Busby', 66800, 'Product Management');
insert into employees2 (first_name, last_name, salary, department) values ('Tommie', 'Chinge', 93788, 'Support');
insert into employees2 (first_name, last_name, salary, department) values ('Germayne', 'Slee', 69136, 'Sales');
insert into employees2 (first_name, last_name, salary, department) values ('Rock', 'Booley', 20683, 'Legal');
insert into employees2 (first_name, last_name, salary, department) values ('Joleen', 'Chaff', 46948, 'Legal');
insert into employees2 (first_name, last_name, salary, department) values ('Jeffie', 'Brunnstein', 67928, 'Sales');
insert into employees2 (first_name, last_name, salary, department) values ('Betteanne', 'Gromley', 11912, 'Accounting');
insert into employees2 (first_name, last_name, salary, department) values ('Timothy', 'Tynewell', 84223, 'Business Development');
insert into employees2 (first_name, last_name, salary, department) values ('Rodrigo', 'Stobbes', 60699, 'Research and Development');
insert into employees2 (first_name, last_name, salary, department) values ('Eartha', 'Bayliss', 55813, 'Human Resources');
insert into employees2 (first_name, last_name, salary, department) values ('Eva', 'Borthe', 65623, 'Marketing');
insert into employees2 (first_name, last_name, salary, department) values ('Madelaine', 'Rodman', 15327, 'Support');
insert into employees2 (first_name, last_name, salary, department) values ('Fraze', 'McEnhill', 83274, 'Engineering');
insert into employees2 (first_name, last_name, salary, department) values ('Hillie', 'Dabinett', 74440, 'Engineering');
insert into employees2 (first_name, last_name, salary, department) values ('Vinnie', 'Josipovitz', 72247, 'Human Resources');
insert into employees2 (first_name, last_name, salary, department) values ('Lucas', 'Annwyl', 18584, 'Services');
insert into employees2 (first_name, last_name, salary, department) values ('Robbi', 'O''Noulane', 99554, 'Accounting');
insert into employees2 (first_name, last_name, salary, department) values ('Petey', 'Snewin', 93928, 'Sales');
insert into employees2 (first_name, last_name, salary, department) values ('Rina', 'McBayne', 55215, 'Legal');
insert into employees2 (first_name, last_name, salary, department) values ('Dicky', 'Freddi', 18300, 'Training');
insert into employees2 (first_name, last_name, salary, department) values ('Thaxter', 'Cottem', 13485, 'Services');
insert into employees2 (first_name, last_name, salary, department) values ('Lynelle', 'Cortnay', 44221, 'Sales');
insert into employees2 (first_name, last_name, salary, department) values ('Ottilie', 'Gilcriest', 95205, 'Legal');
insert into employees2 (first_name, last_name, salary, department) values ('Dud', 'Birchner', 36846, 'Human Resources');
insert into employees2 (first_name, last_name, salary, department) values ('Hally', 'Rehm', 10068, 'Research and Development');
insert into employees2 (first_name, last_name, salary, department) values ('Stephi', 'Kildea', 79771, 'Services');
insert into employees2 (first_name, last_name, salary, department) values ('Perle', 'Denisard', 98807, 'Marketing');
insert into employees2 (first_name, last_name, salary, department) values ('Celeste', 'Breckwell', 15069, 'Product Management');
insert into employees2 (first_name, last_name, salary, department) values ('Daisi', 'Heugle', 62596, 'Business Development');
insert into employees2 (first_name, last_name, salary, department) values ('Kennan', 'Guillotin', 83001, 'Engineering');
insert into employees2 (first_name, last_name, salary, department) values ('Marne', 'Combes', 94766, 'Services');
insert into employees2 (first_name, last_name, salary, department) values ('Dasya', 'Geater', 64175, 'Training');
insert into employees2 (first_name, last_name, salary, department) values ('Raleigh', 'Penke', 84592, 'Research and Development');
insert into employees2 (first_name, last_name, salary, department) values ('Ida', 'Bussons', 80107, 'Accounting');
insert into employees2 (first_name, last_name, salary, department) values ('Polly', 'Kissell', 11137, 'Accounting');
insert into employees2 (first_name, last_name, salary, department) values ('Marleah', 'Swatten', 37872, 'Product Management');
insert into employees2 (first_name, last_name, salary, department) values ('Salim', 'Lancastle', 93686, 'Sales');
insert into employees2 (first_name, last_name, salary, department) values ('Aurlie', 'Mounfield', 42078, 'Business Development');
insert into employees2 (first_name, last_name, salary, department) values ('Melloney', 'Widdall', 78910, 'Sales');
insert into employees2 (first_name, last_name, salary, department) values ('Benedict', 'Lewing', 62977, 'Legal');
insert into employees2 (first_name, last_name, salary, department) values ('Perla', 'Benneton', 87571, 'Business Development');
insert into employees2 (first_name, last_name, salary, department) values ('Corrinne', 'Siddaley', 38652, 'Marketing');
insert into employees2 (first_name, last_name, salary, department) values ('Renie', 'Daymont', 10464, 'Sales');
insert into employees2 (first_name, last_name, salary, department) values ('Dorisa', 'Toffler', 78649, 'Accounting');
insert into employees2 (first_name, last_name, salary, department) values ('Ivy', 'Brookbank', 90744, 'Human Resources');
insert into employees2 (first_name, last_name, salary, department) values ('Yasmeen', 'Fanshawe', 88219, 'Research and Development');
insert into employees2 (first_name, last_name, salary, department) values ('Nance', 'Asple', 33086, 'Services');
insert into employees2 (first_name, last_name, salary, department) values ('Christophorus', 'Adrianello', 28127, 'Legal');
insert into employees2 (first_name, last_name, salary, department) values ('Vail', 'Bolderstone', 49605, 'Legal');
insert into employees2 (first_name, last_name, salary, department) values ('Halli', 'Fellibrand', 69935, 'Services');
insert into employees2 (first_name, last_name, salary, department) values ('Zenia', 'Buchanan', 46824, 'Engineering');
insert into employees2 (first_name, last_name, salary, department) values ('Davon', 'Hansod', 51978, 'Engineering');
insert into employees2 (first_name, last_name, salary, department) values ('Hinze', 'Gumb', 71674, 'Legal');
insert into employees2 (first_name, last_name, salary, department) values ('Merrile', 'Lutwidge', 47130, 'Research and Development');
insert into employees2 (first_name, last_name, salary, department) values ('Franny', 'Seaking', 95171, 'Human Resources');
insert into employees2 (first_name, last_name, salary, department) values ('Lib', 'Dumphry', 28398, 'Engineering');
insert into employees2 (first_name, last_name, salary, department) values ('Rob', 'Buddles', 61188, 'Research and Development');

SELECT department, avg(salary) FROM EMPLOYEES2 GROUP BY department ORDER BY avg(salary) desc;

SELECT * FROM employees2 WHERE last_name = 'Buddles';


CREATE TABLE departments(
	dept_id serial PRIMARY KEY,
	dept_name TEXT
);

INSERT INTO departments (dept_name) values('Legal');
INSERT INTO departments (dept_name) values('HR');
INSERT INTO departments (dept_name) values('R&D');
INSERT INTO departments (dept_name) values('Training');
INSERT INTO departments (dept_name) values('Coaching');
INSERT INTO departments (dept_name) values('Payroll');
INSERT INTO departments (dept_name) values('Accounting');


create table employees3 (
	emp_id serial PRIMARY KEY,
	first_name VARCHAR(50),
	last_name VARCHAR(50),
	age INT,
	salary INT,
	zip VARCHAR(50),
	dept_id INT REFERENCES departments
);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Baxie', 'Westrip', null, 26966, null, 4);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Caryl', 'Casetta', null, 66115, null, 1);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Nike', 'Jansson', null, 76054, '83880-000', 5);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Reginauld', 'Wornum', 46, 33907, null, 3);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Leticia', 'Layfield', null, 42183, '39680-000', 4);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Annis', 'Bedbury', 47, 43501, null, 5);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Nita', 'Tailby', 45, 39734, null, 5);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Cornelle', 'Burniston', 48, 40030, '1053', 5);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Rinaldo', 'Lainge', 42, 10331, null, 4);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Kaitlynn', 'Bartolomieu', null, 88200, null, 5);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Brenn', 'Icke', 42, 50373, '74701', 4);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Janeta', 'Giacubo', 50, 42446, null, 4);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Stuart', 'Conduit', null, 64441, null, 4);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Margarita', 'Cowley', null, 35657, null, 5);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('La verne', 'Springtorpe', null, 55707, '50933', 4);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Tish', 'Descroix', null, 28774, null, 1);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Michaeline', 'Palombi', null, 98020, null, 4);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Hamish', 'Usher', null, 49810, '7001', 2);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Ardella', 'Cristofanini', null, 54172, null, 4);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Pasquale', 'Fuchs', 46, 29738, null, 5);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Marten', 'Caldairou', 50, 54024, null, 2);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Cindy', 'Linsay', 44, 96194, '2775-381', 3);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Felicdad', 'Shear', 48, 88684, null, 1);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Zackariah', 'Descroix', 45, 47101, '603 72', 1);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Perice', 'Parlett', 44, 33897, '9404', 2);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Mandie', 'Phuprate', null, 68055, '76404 CEDEX', 5);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Abbey', 'Benedettini', 42, 95720, '92980 CEDEX', 5);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Annabal', 'Purdom', 50, 38499, '4421', 4);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Sonia', 'Arnoll', 44, 74907, '526-0212', 4);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Mayer', 'Agget', 43, 98268, '923 98', 2);


SELECT * FROM EMPLOYEES3;

-- AVG
-- Returns the average value of a column of numbers
SELECT AVG(salary) FROM EMPLOYEES3;

-- SUM
-- Returns the sum of a column of numbers
SELECT SUM(Salary) FROM EMPLOYEES3 E;

-- MIN
-- Returns the minimum of a column of numbers
SELECT Min("age") FROM EMPLOYEES3 E;

-- MAX
-- Returns the maximum value from a column of numbers
SELECT max("age") FROM EMPLOYEES3 E;

-- COUNT
-- Count returns the number of entries in a column 
-- More useful for criteria measuring
SELECT * FROM EMPLOYEES3 E WHERE salary > 80000;
SELECT count(*) FROM EMPLOYEES3 E WHERE salary > 80000;

SELECT count("age") FROM EMPLOYEES3 E WHERE "age" IS NOT NULL;

SELECT "age", avg(salary) FROM EMPLOYEES3 E GROUP BY "age";

-- Let's say we wanted to show the max salary by department
SELECT DEPT_ID, max(salary) FROM EMPLOYEES3 E GROUP BY dept_id ;
-- This is a good start but the dept_id's are not super useful from a viewer standpoint
-- Let's do an inner join
SELECT dept_name, max(SALARY) FROM EMPLOYEES3 
INNER JOIN DEPARTMENTS 
ON EMPLOYEES3.DEPT_ID = DEPARTMENTS.DEPT_ID
GROUP BY dept_name; 

SELECT *FROM EMPLOYEES3 
INNER JOIN DEPARTMENTS 
ON EMPLOYEES3.DEPT_ID = DEPARTMENTS.DEPT_ID; 

SELECT * FROM EMPLOYEES3 
LEFT JOIN DEPARTMENTS 
ON EMPLOYEES3.DEPT_ID = DEPARTMENTS.DEPT_ID;

SELECT * FROM EMPLOYEES3 
Right JOIN DEPARTMENTS 
ON EMPLOYEES3.DEPT_ID = DEPARTMENTS.DEPT_ID;

-- Let's add some records to show outer join
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Arlie', 'Impy', 47, 92662, '2419', null);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Charmane', 'Shearmur', 46, 36788, null, null);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Hinda', 'Datte', 40, 41679, '161350', null);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Sibelle', 'Bezley', 44, 58256, null, null);
insert into employees3 (first_name, last_name, age, salary, zip, dept_id) values ('Elinore', 'Hackleton', 49, 70020, '30506', null);

SELECT * FROM EMPLOYEES3 
Full JOIN DEPARTMENTS 
ON EMPLOYEES3.DEPT_ID = DEPARTMENTS.DEPT_ID;

-- Number of people in the coaching department
SELECT count(*) FROM EMPLOYEES3
INNER JOIN DEPARTMENTS
ON employees3.DEPT_ID = departments.DEPT_ID 
WHERE dept_name = 'Coaching';

-- Query to show the first and last names of everyone in coaching
SELECT FIRST_NAME, LAST_NAME, dept_name  FROM EMPLOYEES3
INNER JOIN DEPARTMENTS
ON employees3.DEPT_ID = departments.DEPT_ID 
WHERE dept_name = 'Coaching';
